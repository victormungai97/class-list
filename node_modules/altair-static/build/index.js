"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fs_1 = require("fs");
var path_1 = require("path");
/**
 * Render Altair Initial options as a string using the provided renderOptions
 * @param renderOptions
 */
exports.renderInitialOptions = function (_a) {
    var _b = _a === void 0 ? {} : _a, endpointURL = _b.endpointURL, subscriptionsEndpoint = _b.subscriptionsEndpoint, initialQuery = _b.initialQuery, initialVariables = _b.initialVariables, initialHeaders = _b.initialHeaders, initialPreRequestScript = _b.initialPreRequestScript, instanceStorageNamespace = _b.instanceStorageNamespace;
    var result = '';
    if (endpointURL) {
        result += "window.__ALTAIR_ENDPOINT_URL__ = `" + endpointURL + "`;";
    }
    if (subscriptionsEndpoint) {
        result += "window.__ALTAIR_SUBSCRIPTIONS_ENDPOINT__ = `" + subscriptionsEndpoint + "`;";
    }
    if (initialQuery) {
        result += "window.__ALTAIR_INITIAL_QUERY__ = `" + initialQuery + "`;";
    }
    if (initialVariables) {
        result += "window.__ALTAIR_INITIAL_VARIABLES__ = `" + initialVariables + "`;";
    }
    if (initialPreRequestScript) {
        result += "window.__ALTAIR_INITIAL_PRE_REQUEST_SCRIPT__ = `" + initialPreRequestScript + "`;";
    }
    if (initialHeaders) {
        result += "window.__ALTAIR_INITIAL_HEADERS__ = " + JSON.stringify(initialHeaders) + ";";
    }
    if (instanceStorageNamespace) {
        result += "window.__ALTAIR_INSTANCE_STORAGE_NAMESPACE__ = `" + instanceStorageNamespace + "`;";
    }
    return result;
};
/**
 * Render Altair as a string using the provided renderOptions
 * @param renderOptions
 */
exports.renderAltair = function (options) {
    if (options === void 0) { options = {}; }
    var altairHtml = fs_1.readFileSync(path_1.resolve(__dirname, 'dist/index.html'), 'utf8');
    var initialOptions = exports.renderInitialOptions(options);
    var baseURL = options.baseURL || './';
    if (!initialOptions) {
        return altairHtml.replace(/<base.*>/, "<base href=\"" + baseURL + "\">");
    }
    if (options.serveInitialOptionsInSeperateRequest) {
        return altairHtml.replace(/<base.*>/, "<base href=\"" + baseURL + "\"><script src=\"initial_options.js\"></script>");
    }
    else {
        return altairHtml.replace(/<base.*>/, "<base href=\"" + baseURL + "\"><script>" + initialOptions + "</script>");
    }
};
/**
 * Returns the path to Altair assets, for resolving the assets when rendering Altair
 */
exports.getDistDirectory = function () { return path_1.resolve(__dirname, 'dist'); };
exports.default = exports.renderAltair;
//# sourceMappingURL=index.js.map